<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Antonia Vinos | Reservas</title>
    <link href="https://fonts.cdnfonts.com/css/reforma-1918" rel="stylesheet">           
    <link rel="stylesheet" href="styles.css">
    <style>
        #resultMessage {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
            font-size: 1rem;
            display: none; /* Oculto por defecto */
        }
        #resultMessage.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        #resultMessage.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
  <header>
    <nav class="navbar">
      <div class="menu">
        <div class="menu-links">
          <a href="/Html/Español html/index.html">INICIO</a>
          <a href="/Html/Español html/Experiencias.html">EVENTOS</a>
          <a href="https://api.whatsapp.com/send/?phone=5493512192815&text=Hola+Antonia+Vinos%2C+quisiera+m%C3%A1s+info+sobre&type=phone_number&app_absent=0">CONTACTO</a>
        </div>
      </div>
    </nav>
    <nav role="navigation" class="primary-navigation">
      <ul>
        <li><a href="#">Idioma &dtrif;</a>
          <ul class="dropdown">
            <li><a href="index.html">Español <img src="/Html/Español html/jpg/es-ar.png" alt="Bandera Argentina"></a></li>
            <li><a href="/Html/Ingles html/index.html">Inglés <img src="/Html/Español html/jpg/en-us.png" alt="US Flag"></a></li>
            <li><a href="/Html/Portuges html/index.html">Portugués <img src="/Html/Español html/jpg/pt-br.png" alt="Bandera Brasil"></a></li>
          </ul>
        </li>
      </ul>
    </nav>
    <div class="antoniavinos">
      <div>
        <img id="logo" src="/Html/Español html/jpg/Logotipo Antonia - Negativo blanco png.png" alt="Antonia Vinos logo"> 
      </div>
    </div>
  </header>
  
  <div class="container">
    <div class="form-container">
      <h2>Formulario de Reserva</h2>
      <form id="reserva-form">
        <label for="nombre">Nombre Completo:</label>
        <input type="text" id="nombre" name="nombre" required>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>

        <label for="telefono">Teléfono:</label>
        <input type="text" id="telefono" name="telefono" required>
        
        <label for="bodegas">Bodegas:</label>
        <select id="bodegas" name="bodegas" required>
            <option value="Atamisque">Atamisque</option>
            <option value="Baron B">Baron B</option>
            <option value="Chandon">Chandon</option>
            <option value="La Caroyense">La Caroyense</option>
            <option value="La Caroyense">La Rural</option>
            <option value="Lopez">Lopez</option>
            <option value="Santa Julia">Santa Julia</option>
        </select>
        <label for="visitantes">Visitantes:</label>
        <select id="visitantes" name="visitantes" required>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
        </select>

        <label for="idioma">Idioma:</label>
        <select id="idioma" name="idioma" required>
          <option value="Español">Español</option>
        </select>

        <label for="fecha">Fecha:</label>
        <input type="date" id="fecha" name="fecha" required>

     
        
        
        
        <label for="hora">Hora:</label>
        <select id="hora" name="hora" required>
        </select>

        <button type="submit">Reservar</button>
      </form>
      <div id="resultMessage"></div> <!-- Contenedor para el mensaje -->
    </div>
    
    <div class="tour-info">
      <h2>Detalles del Tour</h2>
      <p>En las degustaciones de Antonia Vinos se les dara la mejor experiencia.</p>
      <p>Dependiendo la eleccion de bodega, la experiencia sera diferente.</p>
      
      <h3>Condiciones de reserva:</h3>
      <ul>
        <li>Ningún cargo será realizado al momento de reservar.</li>
        <li>Se solicita una tarjeta solo para asegurar la reserva.</li>
        <li>Pagará el monto total el día de la reserva.</li>
        <li>Menores de 18 años no tienen permitida la actividad.</li>
      </ul>
      <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2406.474972287446!2d-64.18898269730093!3d-31.46177067431257!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9432a351f8ac05c7%3A0xccbd44eb6969c8da!2sAntonia%20Vinos%20con%20Historia!5e0!3m2!1ses-419!2sar!4v1724362947764!5m2!1ses-419!2sar" width="400" height="300" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
  </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
        const bodegaSelect = document.getElementById('bodegas');
        const fechaInput = document.getElementById('fecha');
        const horaSelect = document.getElementById('hora');

        // Fechas permitidas por bodega (ejemplo)
        const fechasPorBodega = {
            "Atamisque": ["2024-11-21", "2024-11-24"],
            "Baron B": ["2024-11-28", "2024-12-01"],
            "Chandon": ["2024-12-05", "2024-12-08"],
            "La Caroyense": ["2024-12-12", "2024-12-15"],
            "La Rural": ["2024-12-19", "2024-12-22"],
            "Lopez": ["2024-12-26", "2024-12-29"],
            "Santa Julia": ["2025-01-02", "2025-01-05"]
        };

        // Horarios permitidos por bodega
        const horariosPorBodega = {
            "Atamisque": ["19:00","21:00", "23:00"],
            "Baron B": ["19:00","21:00", "23:00"],
            "Chandon": ["19:00","21:00", "23:00"],
            "La Caroyense":["19:00","21:00", "23:00"],
            "La Rural":["19:00","21:00", "23:00"],
            "Lopez": ["19:00","21:00", "23:00"],
            "Santa Julia": ["19:00","21:00", "23:00"]
        };

        // Cambiar fechas y horarios según la bodega seleccionada
        bodegaSelect.addEventListener('change', function () {
            const bodegaSeleccionada = bodegaSelect.value;

            // Actualizar las fechas permitidas
            const fechasDisponibles = fechasPorBodega[bodegaSeleccionada] || [];
            fechaInput.min = fechasDisponibles[0] || "";
            fechaInput.max = fechasDisponibles[fechasDisponibles.length - 1] || "";

            // Actualizar los horarios permitidos
            const horariosDisponibles = horariosPorBodega[bodegaSeleccionada] || [];
            horaSelect.innerHTML = ""; // Limpiar opciones
            horariosDisponibles.forEach(hora => {
                const option = document.createElement("option");
                option.value = hora;
                option.textContent = hora;
                horaSelect.appendChild(option);
            });
        });

        // Disparar cambio inicial para establecer restricciones por defecto
        bodegaSelect.dispatchEvent(new Event('change'));
    });
</script>
  <script>
   document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('reserva-form');
    const resultMessage = document.getElementById('resultMessage');

    form.addEventListener('submit', function (event) {
        event.preventDefault();

        const formData = new FormData(form);

        fetch('http://localhost/proyectofinal/verificar_disponibilidad.php', {
            method: 'POST',
            body: formData
        })
        .then(response => response.text())
        .then(data => {
            if (data.includes('No hay disponibilidad')) {
                alert(data); // Mostrar mensaje si no hay espacio
            } else {
                // Si hay disponibilidad, enviar la reserva
                return fetch('http://localhost/proyectofinal/reserva.php', {
                    method: 'POST',
                    body: formData
                });
            }
        })
        .then(response => response.text())
        .then(data => {
            // Asegúrate de que el servidor solo devuelve mensajes simples.
            if (data.includes('<html')) {
                console.error('El servidor devolvió HTML inesperado.');
                resultMessage.innerText = 'Error inesperado. Por favor, intente más tarde.';
                resultMessage.className = 'error';
            } else {
                resultMessage.innerText = data;
                resultMessage.className = 'success';
            }
            resultMessage.style.display = 'block';
            form.reset();
        })
        .catch(error => {
            resultMessage.innerText = 'Hubo un error. Intente nuevamente.';
            resultMessage.className = 'error';
            resultMessage.style.display = 'block';
            console.error('Error:', error);
        });
    });
});

  </script>

</body>
</html>
